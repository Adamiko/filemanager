"use strict";var filemanager=angular.module("filemanager",["ngRoute"]);angular.module("filemanager").filter("fileMime",function(){return function(filesList,fileMimeTypesList){var files=[];return"undefined"==typeof fileMimeTypesList||0===fileMimeTypesList.length?filesList:(filesList.forEach(function(file){fileMimeTypesList.indexOf(file.mime)>-1&&files.push(file)}),files)}}),angular.module("filemanager").factory("FileObj",["FileTypes","FileIcons",function(FileTypes,FileIcons){function FileObj(data){this.image=!1,this.icon=!1,this.setData(data)}return FileObj.prototype={setData:function(data){angular.extend(this,data),this.image=FileTypes.images.indexOf(this.mime)>-1?!0:!1,this.image||(this.icon=FileIcons.getIconPath(this.src))},isImage:function(){return this.image}},FileObj}]).factory("DirObj",function(){function DirObj(data){this.setData(data)}return DirObj.prototype={setData:function(data){angular.extend(this,data)}},DirObj}),angular.module("filemanager").service("FileTypes",function(){this.images=["image/jpg","image/jpeg","image/png","image/gif","image/png"],this.audio=["audio/mpeg","audio/x-ms-wma","audio/vnd.rn-realaudio","audio/x-wav"],this.video=["video/mpeg","video/mp4","video/quicktime","video/x-ms-wmv"],this.archive=["application/zip"]}).service("FileIcons",function(){this.imagesExtensions=["aac","ai","aiff","avi","_blank","bmp","c","cpp","css","dat","dmg","doc","dotx","dwg","dxf","eps","exe","flv","gif","h","hpp","html","ics","iso","java","jpg","js","key","less","mid","mp3","mp4","mpg","odf","ods","odt","otp","ots","ott","_page","pdf","php","png","ppt","psd","py","qt","rar","rb","rtf","sass","scss","sql","tga","tgz","tiff","txt","wav","xls","xlsx","xml","yml","zip"],this.getIconPath=function(fileName){var ext=fileName.substr(_.lastIndexOf(fileName,".")+1);return this.imagesExtensions.indexOf(ext)>-1?"/data/icons/"+ext+".png":"/data/icons/_blank.png"}}),angular.module("filemanager").controller("MainCtrl",["$scope","$http","DirObj","FileObj",function($scope,$http,DirObj,FileObj){$scope.dirs=[],$scope.files=[],$scope.fileTypeFilter=!1,$scope.fileTypes={images:["image/jpg","image/jpeg","image/png","image/gif","image/png"],audio:["audio/mpeg","audio/x-ms-wma","audio/vnd.rn-realaudio","audio/x-wav"],video:["video/mpeg","video/mp4","video/quicktime","video/x-ms-wmv"],archive:["application/zip"]},$http.get("/data/directory.json").success(function(data){data.dirs.forEach(function(dirData){$scope.dirs.push(new DirObj(dirData))}),data.files.forEach(function(fileData){$scope.files.push(new FileObj(fileData))})}),$scope.setFilterType=function(filterName){$scope.fileTypeFilter=filterName&&filterName!==!1&&$scope.fileTypes[filterName]?filterName:!1}}]);